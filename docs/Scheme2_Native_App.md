# 方案二：跨平台 Native 应用 (纯内网广播模式)

### 1. 核心架构
这种方案不再依赖任何外部云服务（如 Cloudflare），而是通过在系统底层运行一个小型的 HTTP/TCP 服务来实现。

- **核心引擎 (Backend)**：使用 Rust (Tauri)、Go (Wails) 或 Node.js 开发的后台进程。
- **服务发现 (mDNS/UDP)**：利用局域网广播协议自动寻找同网设备。
- **内网服务器**：每个设备在启动时在随机端口开启一个临时的本地 HTTP 服务。

### 2. 实现逻辑

#### A. 自动发现
1. 应用启动，通过 UDP 广播告知局域网：“我是‘小明的手机’，IP 是 192.168.1.5，我在监听 9999 端口”。
2. 同网其他设备收到广播，自动在 UI 上列出该设备。
3. 如果输入 3 位数字房间号，则只过滤并显示相同房间号的广播。

#### B. 数据分发
- **历史记录**：房间创建者在本地开启一个 WebSocket 服务，所有人连上该服务。
- **数据存储**：历史记录保存在创建者的本地 SQLite 数据库中。

#### C. 直接拉取传输
1. 分享者分享文件，系统记录其本地物理路径（如 `/Users/hexu/Download/photo.jpg`）。
2. 被分享设备获得一个内网链接：`http://192.168.1.5:9999/download?fileId=xxx`。
3. 点击下载时，浏览器或应用直接发起 HTTP Get 请求，数据在局域网内以满速传输。

### 3. 优缺点
- **优点**：真正的“零网络”可用，Wi-Fi 断了网也能传；自动搜索，体验最接近 AirDrop；性能最强（直接读写磁盘）。
- **缺点**：需要分发不同的安装包（.apk, .ipa, .exe, .dmg）；移动端（iOS）后台常驻受限。

---
